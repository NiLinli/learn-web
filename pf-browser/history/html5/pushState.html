<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>pushState</title>
</head>

<body>
    <div id="btnGroup">
        <button id="btn1">push page1 into history stack</button>
        <button id="btn2">push page2 into history stack</button>
        <button id="btn3">push page3 into history stack</button>
    </div>

    <button id="btn4">replace</button>
</body>


<script>
    var btn1 = document.getElementById('btn1'),
        btn2 = document.getElementById('btn2'),
        btn3 = document.getElementById('btn3');

    var btnGroup = document.getElementById('btnGroup');

    window.addEventListener('popstate', function (e) {
        console.log('popstate event:', history.length);
    });

    btnGroup.addEventListener('click', function (e) {

        var id = e.target.id;
        var map = {
            btn1: 'bar1.html',
            btn2: 'bar2.html',
            btn3: 'bar3.html',
        };
        var stateObj = { foo: id };
        history.pushState(stateObj, null, map[id]);

        console.log('history.state', history.state);
        console.log('pushState:', history.length );
    });

    document.getElementById('btn4').addEventListener('click', function(){
        history.replaceState(null, null, 'bar5.html');
    })
</script>

</html>